<section class="dashboard-wrapper">
  <div class="container-fluid">
    <div class="row">
      <div class="col-12 col-md-12">
        <mat-accordion>
          <mat-expansion-panel
            (opened)="togglePanelState(true)"
            (closed)="togglePanelState(false)"
          >
            <mat-expansion-panel-header class="panel-header">
              <mat-panel-title class="d-flex gap-2 align-items-center">
                <git-icons
                  [name]="'github'"
                  [width]="'94px'"
                  [height]="'100%'"
                />
                <ng-container *ngIf="statusDetail && statusDetail?.connected">
                  <mat-icon style="color: green">check_circle</mat-icon>
                  <mat-icon>history</mat-icon>
                </ng-container>
              </mat-panel-title>

              <ng-container *ngIf="statusDetail?.connected">
                <mat-panel-description class="panel-description">
                  @if(syncLoader) {
                  <div class="d-flex flex-row align-items-center gap-2">
                    <mat-spinner class="loader"></mat-spinner>
                    <span style="font-size: 13px; font-weight: 400;">Syncing...</span>
                  </div>
                  } @else { Admin: Last Synced:
                  {{statusDetail.integration.connectedAt |
                  date:'YYYY-MM-ddhh:mma'}}
                  <br />
                  Sync Type: {{ syncCompleted ? 'Full' : 'not synced'}} }
                </mat-panel-description>
              </ng-container>
            </mat-expansion-panel-header>

            <ng-container *ngIf="statusDetail?.connected">
              <div
                class="d-flex align-items-center justify-content-end gap-1 pt-5"
              >
                <button
                  mat-flat-button
                  color="primary"
                  type="button"
                  class="d-flex align-items-center"
                  (click)="removeAccount()"
                >
                  <span>Remove &nbsp;</span>
                  <git-icons
                    [name]="'private'"
                    [width]="'18px'"
                    [height]="'18px'"
                  />
                </button>
              </div>
            </ng-container>

            <ng-container *ngIf="!statusDetail?.connected">
              <div
                class="d-flex flex-column align-items-center justify-content-center pt-5"
              >
                <button
                  mat-flat-button
                  color="primary"
                  type="button"
                  (click)="connect()"
                >
                  Connect
                </button>
                <h3 class="mt-3 text-primary">
                  <strong>Connect Sredio to Github</strong>
                </h3>
              </div>
            </ng-container>
          </mat-expansion-panel>
        </mat-accordion>
      </div>

      @if(statusDetail && statusDetail.connected) {
      <div class="col-12 col-md-12 mt-2">
        <mat-card>
          <mat-card-content><git-repos /></mat-card-content>
        </mat-card>
      </div>
      }
    </div>
  </div>
</section>
